{{ assign 'blsize' (minus (size section.blocks) 1) }}
{{ assign 'secidlast' (replace section.id '-' '_') }}
{{#if section.settings.bg_image }}
  <style>
    #tnv30changeimg-{{ secidlast }}{
        background: url("{{ image_url section.settings.bg_image }}") no-repeat;
          background-size: 100% auto;
    background-position: center bottom;
    }
  </style>
{{/if}}
  <div class="tnv30changeimg-container" id="tnv30changeimg-{{ secidlast }}" > 
   <div class="tnv30changeimg-box container-ho">  

  <div class="proanicgimage-left">
   {{#each section.blocks as |block| }}
   <div class="proanicgimage-item proanicgimage-item-{{@index}}">
     {{#if block.settings.image }}
    <img alt="{{ block.settings.image.alt }}" class="hide-mb" src="{{ image_url block.settings.image }}"/>
    <img alt="{{ block.settings.image_mb.alt }}" class="hide-pc" src="{{ image_url block.settings.image_mb }}"/>
     {{/if}}
    </div>
   {{/each}}
    </div> 
     
     <div class="proanicgimage-right">
        {{#each section.blocks as |block| }}
          <div class="proanicgimage-right-item proanicgimage-ritem-{{@index}} {{#if @index '==' 0 }}active{{/if }}" {{ blsize }}>
          {{#if block.settings.title '!=' '' }}
            <div class="proanicgimage-ritem-title">{{ block.settings.title }}</div>
           {{/if}}
          {{#if block.settings.content '!=' '' }}
            <div class="proanicgimage-ritem-content">{{{ block.settings.content }}}</div>
           {{/if}}
          {{#if block.settings.videourl '!=' '' }}
           <video class="cgimg_video" width="100%" {{#if @index '==' 0 }}autoplay="autoplay"{{/if}}loop="loop" muted="muted" preload="metadata" webkit-playsinline="true" playsinline="true" x5-playsinline="true" x-webkit-airplay='allow' >
        <source src="{{ block.settings.videourl }}"/>
        </video>
           {{/if}}
          </div>
       {{/each}}
     </div>

     
   </div>
    
  </div>
{{#if (size section.blocks) '>' 1 }}
<script> 
    $(function(){
      
       var controller_{{secidlast}} = new ScrollMagic.Controller();
       var tweenmaxthr_{{secidlast}} = new TimelineMax()
      {{#each section.blocks as |block| }}
      {{#unless @index '==' (size section.blocks) }}
       .add([
         TweenMax.to(".site-header", 1.5, {className: "+=hidehd"}),           
       ])
       .add([
         {{#and @index '>' 1  @index '!=' blsize }}TweenMax.to(".proanicgimage-item-{{@index}}", 1.5, { opacity: "0"}),{{/and}}
          TweenMax.to(".proanicgimage-item-{{@index}}", 2, { transform: "translateY(-8%) scale(0.9)",opacity: "0.8"}),
          TweenMax.to(".proanicgimage-item-{{ plus @index 1 }}", 0.5, { opacity: "1"}),
          TweenMax.to(".proanicgimage-item-{{ plus @index 1 }}", 2, { transform: "translateY(60%)",
                            onReverseComplete: function () {
                             $(".proanicgimage-right-item").removeClass("active");
                             $(".proanicgimage-ritem-{{@index}}").addClass("active");
                             $(".cgimg_video").trigger('pause');
                              $(".proanicgimage-ritem-{{@index}}").find(".cgimg_video")[0].currentTime = 0;
                              $(".proanicgimage-ritem-{{@index}}").find(".cgimg_video").trigger('play');
                            }}),
       ])
       .add([
         TweenMax.to(".site-header", 0.5, {className: "+=hidehd",onStart: function () {
                              $(".proanicgimage-right-item").removeClass("active");
                             $(".proanicgimage-ritem-{{ plus @index 1 }}").addClass("active");
                             $(".cgimg_video").trigger('pause');
                              $(".proanicgimage-ritem-{{ plus @index 1 }}").find(".cgimg_video")[0].currentTime = 0;
                              $(".proanicgimage-ritem-{{ plus @index 1 }}").find(".cgimg_video").trigger('play');
              
                            }}),           
       ]) 
        .add([
          TweenMax.to(".proanicgimage-item-{{@index}}", 2, { transform: "translateY(-9%) scale(0.9)",opacity: "0.6"}),
          TweenMax.to(".proanicgimage-item-{{ plus @index 1 }}", 2, { transform: "translateY(0%)"}),
       ])
      {{/unless}}
       {{/each}}
       .add([
         TweenMax.to(".site-header", 2, {className: "+=hidehd"}),           
       ]);
             
        
      
     var beishu_nine = $(window).width()/1920;
      if($(window).width() > 768){
        var n_beshu = beishu_nine*465; //偏移量  
        var offsetho = 900;  //滚动快慢  
      }else if($(window).width() <= 768 && $(window).width() > 550){
         var n_beshu = beishu_nine*800; //偏移量  
         var offsetho = 300;  //滚动快慢  
      }else{
       var n_beshu = beishu_nine*1800; //偏移量  
         var offsetho = 300;  //滚动快慢 
      } 
        
        
                  
     $(window).resize(function() {      
        if($(window).width() > 768){
        var n_beshu = beishu_nine*465; //偏移量  
             var offsetho = 900;  //滚动快慢  
      }else if($(window).width() <= 768 && $(window).width() > 550){
         var n_beshu = beishu_nine*800; //偏移量  
         var offsetho = 300;  //滚动快慢  
      }else{
       var n_beshu = beishu_nine*1800; //偏移量  
         var offsetho = 300;  //滚动快慢 
      }       
      });
      
      

        new ScrollMagic.Scene({triggerElement: "#tnv30changeimg-{{ secidlast }}", duration: offsetho*{{blsize}},offset: n_beshu})
        .setTween(tweenmaxthr_{{secidlast}})
		.setPin("#tnv30changeimg-{{ secidlast }}")
        .addTo(controller_{{secidlast}}); 

      
      
      
      
    });
            
    
</script>

 
{{/if }}

{{#schema}}
  {
    "name": "Product ImageChange",
    "settings": [
      {
            "type": "image_picker",
            "id": "bg_image",
            "label": "Background Image"
       }
    ],
    "blocks": [
      {
        "type": "block",
        "name": "block",
        "settings": [
          {
            "type": "image_picker",
            "id": "image",
            "label": "Image"
          },{
            "type": "image_picker",
            "id": "image_mb",
            "label": "Image Mobile"
       },{
            "type": "text",
            "id": "videourl",
            "label": "video url"
         },{
            "type": "text",
            "id": "title",
            "label": "title"
         },{
            "type": "richtext",
            "id": "content",
            "label": "content"
         }
        ]
      }
    ],
    "presets": [
      {
        "name": "Product ImageChange",
        "category": "Ho-Advance"
 
      }
    ]
  }
{{/schema}}

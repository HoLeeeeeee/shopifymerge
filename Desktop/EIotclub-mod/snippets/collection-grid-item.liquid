{%- liquid
  unless background_position
    assign background_position = 'top center'
  endunless

  if collection == blank
    assign collection_title = 'home_page.onboarding.collection_title' | t
  else
    assign collection_title = collection.title | escape
  endif

  if collection.image
    assign collection_image = collection.image
  else
    assign collection_image = collection.products.first.featured_media.preview_image
  endif
-%}

<div id="grid-{{ id }}" class="grid__item {{ gridView }} skrim__item" data-aos="skrim__animation" {{ block.shopify_attributes }}>
  <a href="{{ url }}" class="skrim__link skrim__item-content">
    {%- if image == blank or collection_image == blank -%}
      {% comment %} {% capture placeholder %}collection-{% cycle 1, 2, 3, 4, 5, 6 %}{% endcapture %} {% endcomment %}
      <div class="skrim__overlay grid__image">

        {% comment %} {{ placeholder | placeholder_svg_tag: 'placeholder-svg' }} {% endcomment %}
        {% if image != blank or image_mo != blank %}
          {{ image | img_url: 'master' | img_tag }}
          {{ image_mo | img_url: 'master' | img_tag }}
        {% else %} 
          {{ collection_image | img_url: 'master' | img_tag }}
          {{ collection_image | img_url: 'master' | img_tag }}
        {% endif %}
      </div>
    {%- else -%}
      <div class="skrim__overlay grid__image">
        {% assign indicator = block.id %}
        {% if block == blank %}
          {% assign indicator = collection.id %}
        {% endif %}

        {% style %}
          .grid__image--{{ indicator }}{
            object-position: {{ background_position }};
          }
        {% endstyle %}

        {% assign classes = 'image-fit grid__image--' | append: indicator %}
        {%- render 'image-element',
          img: collection_image,
          img_width: 2400,
          classes: classes,
          sizes: sizes,
          sizeVariable: sizeVariable,
          fallback: fallback,
        -%}
      </div>
    {%- endif -%}

    <div class="skrim__title">
      <div class="skrim__underline-me" style="color: {{ title_color }};">
        {{ title }}
      </div>
    </div>
  </a>
</div>
<style>
  #grid-{{ id }} .skrim__underline-me::after{
    border-bottom-color: {{  title_color  }};
  }
  #grid-{{ id }} .grid__image img:first-child{
    display: block;
  }
  #grid-{{ id }} .grid__image img:last-child{
    display: none;
  }
  @media(max-width:767px){
    #grid-{{ id }} .grid__image img:first-child{
    display: none;
  }
  #grid-{{ id }} .grid__image img:last-child{
    display: block;
  }
  }
</style>


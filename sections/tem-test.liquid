  <button onclick="makeRequest()">发起请求</button>
  <canvas id="canvas" width="100" height="100"></canvas>
  <style>
    canvas {
      border: 1px solid #000;
    }
  </style>
  <script>
    function makeRequest() {
      var progressBar = document.getElementById('progress');
      var canvas = document.getElementById('canvas');
      var ctx = canvas.getContext('2d');
      var x = canvas.width / 2;
      var y = canvas.height / 2;
      var radius = 30;
      var startAngle = 0;
      var endAngle = 0;
      function read(receivedLength,contentLength) {
            endAngle = (receivedLength / contentLength) * 2 * Math.PI;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.beginPath();
            ctx.arc(x, y, radius, startAngle, endAngle);
            ctx.stroke();
            startAngle = endAngle;
      }



      
      // https://cdn.shopify.com/videos/c/o/v/bfb46e6e3ab544f8bb5284e670e07e52.mp4
      fetch('https://cdn.shopify.com/videos/c/o/v/bfb46e6e3ab544f8bb5284e670e07e52.mp4').then(response => {
        var reader = response.body.getReader();
        var contentLength = +response.headers.get('content-length');
        var receivedLength = 0;

        function read() {
          reader.read().then(({ done, value }) => {
            if (done) {
              console.log('请求完成');
              return;
            }
            receivedLength += value.length;
             read(receivedLength,contentLength);
            read();
          });
        }

        read();
      });
    }
  </script>




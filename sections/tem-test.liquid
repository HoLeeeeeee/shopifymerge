  <button onclick="makeRequest()">发起请求</button>
  <canvas id="canvas" width="100" height="100"></canvas>
  <div id="value"></div>
  <style>
    canvas {
      border: 1px solid #000;
    }
  </style>
  <script>
    function makeRequest() {
      var progressBar = document.getElementById('progress');
      var canvas = document.getElementById('canvas');
      var ctx = canvas.getContext('2d');
      var x = canvas.width / 2;
      var y = canvas.height / 2;
      var radius = 30;
      var startAngle = 0;
      var endAngle = 0;




      
      // https://cdn.shopify.com/videos/c/o/v/bfb46e6e3ab544f8bb5284e670e07e52.mp4
      fetch('https://cdn.shopify.com/s/files/1/0560/0162/6273/files/2_c67442bb-8f7f-4f7e-ab0c-720f20fe5c34.png?v=1688022306').then(response => {
        var reader = response.body.getReader();
        var contentLength = +response.headers.get('content-length');
        var receivedLength = 0;

        function read() {
          reader.read().then(({ done, value }) => {
            if (done) {
              console.log('请求完成');
              return;
            }
            receivedLength += value.length;
            document.getElementById('value').innerText = (receivedLength / contentLength) * 100+"%";
            endAngle = (receivedLength / contentLength) * 2 * Math.PI;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.beginPath();
            ctx.arc(x, y, radius, startAngle, endAngle);
            ctx.strokeStyle = 'blue'; // 设置描边颜色
            ctx.lineWidth = 3; // 设置线条粗细
      ctx.lineWidth = 10; // 设置线条粗细
      ctx.lineCap = 'round'; // 设置线条末端样式为圆形
            ctx.stroke();
            // startAngle = endAngle;
            read();
          });
        }

        read();
      });
    }
  </script>



